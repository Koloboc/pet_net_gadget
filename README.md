# pet_net_gadget: Pet-проект на языке `С`
По мотивам тестового задание в вакансии на job.ru
### Задание:
Имеется несоклько (от 2-х до 100) устройств (gadget) подключенных к сети.
каждое устройство обсалютно эдентично.<br>
У каждого устройства есть информационный дисплей на котором нужно вывести среднее значение показателей датчиков (например яркость и температура) со всех доступных устройств.<br>
Устройства должны по сети договориться о том кто будет "мастером" и будет считать средние значения.<br>
Сеть не является стабильной сущностью и переодически меняется, вследствии чего некоторые устройства отваливаются или подсоединяются и т.п.<br>
Некоторые устройства оказываются в изолированом сегменте сети...<br>
Есть одно устройство, которое является "мастером". При появлении мастера в сети, он дожен брать управление на себя.<br>

=============================================================================<br>
Сообщение всегда содержит:<br>
		ID - идентификатор устройства<br>
		data - данные датчиков (brithness, temp)<br>

------------------------
## Как это работает.
------------------------
1. при включении устройства ему назначется случайный ID (от 1 до 100).
2. Посылает broadcast сообщение с актуальными данными датчиков в сеть.
3. Ждет timout<br>
	3.1 ничего не пришло в ответ, посылаем еще сообщение(до бесконечности).<br>
	3.2 пришло сообщение с id меньшим id-устройства, увеличиваем timeout, посылаем в ответ(на адрес отправителя) актуальные данные.<br>
	3.3 пришло сообщение с id большим id, считаем среднее и уменьшаем timeout.<br>
	3.4 пришло сообщение с равным id, увеличиваем id на 1 и увеличиваем timeout. <br>
		(или отбрасываем сообщение если адрес отпровителя это наш адрес, т.е. это наше сообщение).<br>

### Прим:<br>

-- timeot = 6 sec (взято с потолка) <br>
-- После включения или различного рода сбоях в сети или назначении одинаковых (случайных id),
   небходимо нескольно итераций (2..3 по 6 сек) для нормализации работы(выяснения кто есть кто)

------------------------
## Запуск в командной строке
------------------------
	1 параметр IP адрес (на котором слушать) Обязательный
	2 параметр порт (на котором слушать) НЕ обязательный (default: 1111)
	3 ID устройства НЕ обязательный (default: random 1 - 100)


------------------------
## Сборка:
------------------------
	git clone https://github.com/Koloboc/pet_net_gadget.git
	cd pet_net_gadget
	mkdir build bin
	cd build
	cmake ..
	make

------------------------
Запуск, пример:
------------------------
Перейти в bin
cd <project_path>/bin

./Gadget 192.168.0.1 5555 10

Вывод каждые 6 сек:<br>
5: brith=91 temp=756
  5: DISPLAY            
      brithness=91     
      temp=756        

